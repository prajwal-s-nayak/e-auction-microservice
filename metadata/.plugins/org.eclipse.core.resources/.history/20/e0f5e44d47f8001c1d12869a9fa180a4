package com.cts.microservices.buyerservice.kafka;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.kafka.core.KafkaTemplate;
import org.springframework.kafka.support.KafkaHeaders;
import org.springframework.messaging.Message;
import org.springframework.messaging.support.MessageBuilder;
import org.springframework.stereotype.Service;

import com.cts.microservices.buyerservice.model.PlaceBidRequest;

@Service
public class AuctionProducer {
	
	public static final Logger LOGGER = LoggerFactory.getLogger(AuctionProducer.class); 

	private KafkaTemplate<String, PlaceBidRequest> kafkaTemlate;
	//private KafkaTemplate<String, String> kafkaTemlate;
	
	
//	public AuctionProducer(KafkaTemplate<String, String> kafkaTemplate) {
//		this.kafkaTemlate = kafkaTemplate;
//	}
	
	
	public AuctionProducer(KafkaTemplate<String, PlaceBidRequest> kafkaTemplate) {
		this.kafkaTemlate = kafkaTemplate;
	}
	
	public void sendAuctionData(PlaceBidRequest placeBidRequest) {
		LOGGER.info(String.format("Message sent %s", placeBidRequest.toString()));
		Message<PlaceBidRequest> message = MessageBuilder.withPayload(placeBidRequest).setHeader(KafkaHeaders.TOPIC,"auction_topic").build();
		kafkaTemlate.send(message); 
	}
	
//	public void sendAuctionData(String placeBidRequest) {
//		LOGGER.info(String.format("Message sent %s", placeBidRequest.toString()));
//		//Message<PlaceBidRequest> message = MessageBuilder.withPayload(placeBidRequest).setHeader(KafkaHeaders.TOPIC,"auction_topic").build();
//		kafkaTemlate.send("auction", placeBidRequest); 
//	}
}
